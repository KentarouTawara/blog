---
title: '関連先のidだけ取得する便利メソッド【Rails】'
date: '2022-06-26'
---

ユーザーが持ってる〇〇（例えば作品）のidを取得したいときがある。

コード的には下記の状態。

```ruby
class User < ApplicationRecord
  has_many :works
end
```

```ruby
class Work < ApplicationRecord
  belongs_to :user
end
```

ひとつはpluckを使う方法がある。
(user = User.first)

```ruby
user.works.pluck(:id) #=> [1,2,3]
```

これを一撃で取得するメソッドがこちら。

```ruby
user.work_ids #=> [1,2,3]
```

has_manyすると「has_manyしているテーブルの単数形_ids」というメソッドが生えるみたい。便利！

参考: has_many (ActiveRecord::Associations::ClassMethods) - APIdock
https://apidock.com/rails/ActiveRecord/Associations/ClassMethods/has_many

```ruby
collection_singular_ids
  Returns an array of the associated objects’ ids
```

(了)
